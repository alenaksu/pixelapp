import{identityMatrix as o}from"../../../utils/index.js";import e from"../../../store/index.js";class d extends HTMLImageElement{constructor(){super();this.updateTransform=()=>{const{translate:a,rotate:i,scale:s,angle:n,flip:t}=e.state.editParams.crop,r=o().rotateSelf(0,0,i+n).translateSelf(a[0]*this.width,a[1]*this.height).scaleSelf(s,s,1);t&&r.scaleSelf(t===1||t===3?-1:1,t===2||t===3?-1:1),this.style.transform=`matrix3d(${r.toFloat32Array()})`},this.addEventListener("load",this.updateTransform)}connectedCallback(){e.on("editParamsChanged",this.updateTransform)}disconnectedCallback(){e.off("editParamsChanged",this.updateTransform)}}customElements.define("pis-source-image",d,{extends:"img"});
